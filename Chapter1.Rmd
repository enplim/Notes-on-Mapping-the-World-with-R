---
title: "Chapter1"
author: "The Caveman Coder"
date: "2025-10-26"
output:
  pdf_document: default
  html_document: default
editor_options:
  markdown:
    wrap: 72
---

My first R script! Lines starting with \# are comments - R ignores them.
They are notes for humans!

Create a variable (a named box) to store a number

```{r}
my_favorite_number <- 7
```

Create a variable to store some text (put text in quotes!)

```{r}
my_city <- "Amsterdam"
```

Print the contents of the variables to the Console

```{r}
print(my_favorite_number)
print(my_city)
```

Do a simple calculation

```{r}
result <- my_favorite_number * 3
print(result)
```

Installing and Loading Essential Packages with pacman

Step 1: Install 'pacman' itself if you don't have it We use install.packages() 
for this one time. 'requireNamespace' checks if it's installed without loading 
it yet. The '!' means NOT. So, "if NOT requireNamespace pacman..."

```{r}
if (!requireNamespace("pacman", quietly = TRUE)) {
  install.packages("pacman")
}
```

Step 2: Load pacman using library() so we can use its functions

```{r}
library(pacman)
```

Step 3: use pacman::p_load() to install (if needed) and load our core
mapping packages. This is the command you'll use often at the start of
your scripts!

```{r}
print("Loading core packages (we will install if missing)...")
p_load(
  sf,           # Core package for vector spatial data
  tidyverse,    # Collection including ggplot2, dplyr, readr, etc.  
  terra         # Core package for raster spatial data
)

print("Core packages sf, tidyverse, and terra are ready!")
```

You might see lots of messages if packages are being installed for the
first time. This is normal! It might take a few minutes. You need an
internet connection.

## Quick CRS Introduction Exercise

Step 1: Ensure sf is loaded

```{r}
pacman::p_load(sf, rnaturalearth) # Need rnaturalearth for the data
```

Step 2: Get world map data as an sf object

```{r}
print("Getting world map data...")
world_sf <- rnaturalearth::ne_countries(
  scale = "medium", returnclass = "sf"
)
print("World data loaded.")
```

Step 3: Check the CRS of this data!

```{r}
print("Checking the original CRS...")
original_crs <- sf::st_crs(world_sf)
print(original_crs)
```

Look for the EPSG code near the bottom! Should be 4326 (WGS84 Lat/Lon)

Step 4: Define a different target CRS (e.g., Robinson Projection)
Robinson is often used for world maps. We use its "ESRI" code here.

```{r}
target_crs_robinson <- "ESRI:54030"
print(paste("Target CRS:", target_crs_robinson))
```

Step 5: Transform the data to the new CRS using st_transform()

```{r}
print("Transforming data to Robinson projection...")
# The |> pipe sends world_sf to the st_transform function
world_robinson_sf <- world_sf |> 
  sf::st_transform(crs = target_crs_robinson)
print("Transformation complete!")
```

Step 6: Check the CRS of the NEW, transformed data

```{r}
print("Checking the NEW CRS...") 
new_crs <- sf::st_crs(world_robinson_sf) 
print(new_crs)
```

Notice the name and details are different now! It's no longer EPSG:4326.

Step 7: Quick plot comparison (using base plot for simplicity here)

```{r}
print( "Plotting comparison (Original vs. Transformed)..." ) 
par(mfrow = c(1, 2)) # Arrange plots side-by-side 
plot( 
  sf::st_geometry(world_sf),
  main = "Original (EPSG:4326)", 
  key.pos = NULL, reset = FALSE, 
  border ="grey" 
) 
plot(
  sf::st_geometry(world_robinson_sf), 
  main = "Transformed (Robinson)", 
  key.pos = NULL, reset = FALSE, 
  border = "blue" 
) 
par(mfrow = c(1, 1)) # Reset plot layout 
print("Plots displayed. Notice the shape difference!")
```
